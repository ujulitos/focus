<section id="biblioteca" class="services">
    <div class="container">

        <div class="section-pretitle">
            <t1>Diálogo de Saberes </t1>
            <tm>/</tm>
            <t2>Saberes de Mujeres</t2>
        </div>

        <div class="section-title" data-aos="fade-right">
            <h2>Biblioteca </h2>
        </div>


        <div class="row_buscador">
            <input id="buscadorLibros" class="buscador_input form-control form-control2" type="text" placeholder="Buscar..." />
            <i id="buscadorClean" class="bx bx-x form-control form-control2"></i>
        </div>





        <div id="rowLibros" class="row row_libros"></div>


    </div>
</section>

<!-- <br> <br> <br> <br> -->

<div class="divisor_final"></div>



<script src="assets/js/audio_player.js"></script>
<script src="assets/js/main.js"></script>



<script>
    $(document).ready(function() {

        activaLibros();

    });

    var cuantosLibros = 0;

    function activaLibros() {
        console.log('activaLibros');

        function cargaLibros() {
            $.ajax({
                url: 'assets/docs/3/3_2/3_2_6/libros.json',
                type: 'get',
                dataType: 'json',
                cache: false,
                success: pintaLibros,
                async: true,
            });
        }
        cargaLibros();
    }

    function pintaLibros(data) {
        console.log(data);

        cuantosLibros = Object.keys(data).length;
        console.log('cuantosLibros', cuantosLibros);

        var contenidoLibros = '';
        $('#rowLibros').empty();

        for (a = 1; a <= cuantosLibros; a++) {

            contenidoLibros += '<div id="tarjeta' + a + '" class="icon-box mt-3">';
            contenidoLibros += '<div class="row">';
            contenidoLibros += '<div class="col-2">';
            contenidoLibros += '<img src="assets/img/libro.png" class="icono_libro" style="width: 100%;" />';
            contenidoLibros += '</div>';
            contenidoLibros += '<div class="col-10">';
            contenidoLibros += '<h4 class="title">' + Object.values(data)[(a - 1)].titulo + '</h4>';
            contenidoLibros += '<p class="description">';
            contenidoLibros += '<b>Autor:</b> ' + Object.values(data)[(a - 1)].autor + '';
            contenidoLibros += '<br>';
            contenidoLibros += '<b>Categoría:</b> ' + Object.values(data)[(a - 1)].tema + '.';
            // contenidoLibros += '<br>';
            // contenidoLibros += '<b>Año:</b> ' + Object.values(data)[(a - 1)].anio + '';
            contenidoLibros += '</p>';
            contenidoLibros += '<div style="text-align: right;">';
            contenidoLibros += '<button class="boton" onclick="abrePDF(' + "'" + Object.values(data)[(a - 1)].archivo + "'" + ');">Abrir libro</button>';
            contenidoLibros += '</div>';
            contenidoLibros += '</div>';
            contenidoLibros += '</div>';
            contenidoLibros += '</div>';

        }

        $('#rowLibros').append(contenidoLibros);




        $("#buscadorLibros").keyup(function() {
            if ($(this).val().length > 2) {
                console.log("buscando", $(this).val());

                for (b = 1; b <= cuantosLibros; b++) {
                    $('#tarjeta' + b).hide();
                    if (Object.values(data)[(b - 1)].titulo.toLowerCase().includes($(this).val().toLowerCase()) ||
                        Object.values(data)[(b - 1)].autor.toLowerCase().includes($(this).val().toLowerCase()) ||
                        Object.values(data)[(b - 1)].tema.toLowerCase().includes($(this).val().toLowerCase())
                        //  || Object.values(data)[(b - 1)].anio.toString().toLowerCase().includes($(this).val().toString().toLowerCase())
                    ) {
                        console.log('Encontré la palabra', $(this).val(), 'con el recurso', Object.values(data)[(b - 1)].titulo, b);
                        $('#tarjeta' + b).fadeIn();
                        // return;
                    } else {
                        console.log('No encontré nada');
                    }
                }

            } else {
                for (b = 1; b <= cuantosLibros; b++) {
                    $('#tarjeta' + b).fadeIn();
                }
            }
        });

        $("#buscadorClean").click(function(e) {
            e.preventDefault();
            $("#buscadorLibros").val('');
            $("#buscadorLibros").keyup();
        });

    }






    function abrePDF(cualPDF) {
        console.log('abrePDF', cualPDF);

        window.open('assets/docs/3/3_2/3_2_6/libros/' + cualPDF + '.pdf');

        // switch (cualPDF) {
        //     case 'libro_1':
        //         window.open('assets/docs/3/3_2/3_2_6/libros/Acosta C., M. y D. Cleghorn. Mujer indígena y cuidados durante el embarazo y puerperio..pdf');
        //         break;
        //     case 'libro_1':
        //         window.open('assets/docs/3/3_2/3_2_6/libros/Acosta C., M. y D. Cleghorn. Mujer indígena y cuidados durante el embarazo y puerperio..pdf');
        //         break;

        //     default:
        //         break;
        // }
    }
</script>