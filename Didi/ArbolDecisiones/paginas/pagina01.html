<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Página 01</title>

    <!-- Estilos -->
    <link rel="stylesheet" href="../css/estilos.css">

    <!-- Librerias -->
    <script src="../js/librerias/jquery.min.js"></script>
    <script src="../js/librerias/gsap.min.js"></script>

    <!-- Script de animaciones -->
    <script src="../js/animaciones.js"></script>
    <!-- Scripts posicionar elementos -->
    <script src="../js/redimensionarElementos.js"></script>
    <script src="../js/posicionar.js"></script>

</head>

<body class="pagina">

    <img class="elementos" id="img01" src="../img/pagina01/img01.png" data-posX="0" data-posY="0" />
    <img class="elementos" id="img02" src="../img/pagina01/img02.png" data-posX="0" data-posY="0" />
    <input class="elementos" id="inputNombre" data-posX="280" data-posY="270" />
    <img class="elementos boton" id="botonRegistrar" src="../img/pagina01/botonRegistrar.png" data-posX="420" data-posY="340" />

    <img class="elementos boton" id="botonRecurso1" src="../img/pagina01/botonRecurso1.png" data-posX="300" data-posY="230" />
    <img class="elementos" id="palomaGris1" src="../img/pagina01/palomaGris.png" data-posX="650" data-posY="228" />
    <img class="elementos" id="palomaAmarilla1" src="../img/pagina01/palomaAmarilla.png" data-posX="650" data-posY="228" />
    <img class="elementos" id="palomaVerde1" src="../img/pagina01/palomaVerde.png" data-posX="650" data-posY="228" />

    <img class="elementos boton" id="botonRecurso2" src="../img/pagina01/botonRecurso2.png" data-posX="300" data-posY="330" />
    <img class="elementos" id="palomaGris2" src="../img/pagina01/palomaGris.png" data-posX="650" data-posY="328" />
    <img class="elementos" id="palomaAmarilla2" src="../img/pagina01/palomaAmarilla.png" data-posX="650" data-posY="328" />
    <img class="elementos" id="palomaVerde2" src="../img/pagina01/palomaVerde.png" data-posX="650" data-posY="328" />

    <style>
        #inputNombre {
            width: 450px;
            height: 35px;
            margin-left: 10px;
            border: none;
            font-size: 20px;
            text-align: center;
            border-bottom: 1px solid var(--principal);
        }

        .boton {
            cursor: pointer;
        }
    </style>
    <!-- Script de la página -->
    <script>
        // Variable----------------------------------------------------
        let aplicacion = parent;
        const img01 = $('#img01');
        const img02 = $('#img02');
        const inputNombre = $('#inputNombre');
        const botonRegistrar = $('#botonRegistrar');

        this.botonRecurso1 = $('#botonRecurso1');
        this.palomaGris1 = $('#palomaGris1');
        this.palomaAmarilla1 = $('#palomaAmarilla1');
        this.palomaVerde1 = $('#palomaVerde1');

        this.botonRecurso2 = $('#botonRecurso2');
        this.palomaGris2 = $('#palomaGris2');
        this.palomaAmarilla2 = $('#palomaAmarilla2');
        this.palomaVerde2 = $('#palomaVerde2');


        var cuantosRecursos = 2;
        var elRecursoNum;
        this.recurso1 = 'ArboldeDesicionesHunter';
        this.recurso2 = 'ArboldeDesicionesFarming';
        this.recursoEstatus1;
        this.recursoEstatus2;
        that = this;


        // Audios------------------------------------------------------
        // const audio = [
        //     new Audio('../audios/DiDi_PER_1.mp3')
        // ]

        // Al cargarse la página
        $(window).on("load", function() {
            redimensionarElementos();
            aplicacion.desactivarBotonAdelante();
            aplicacion.desactivarBotonAtras();
            aplicacion.cargando(iniciarContenido);
        });

        function iniciarContenido() {
            animacionEntrada(img01, 'aparecer', 1, 0);
            animacionEntrada(img02, 'aparecer', 1, .5);
            animacionEntrada(inputNombre, 'aparecer', 1, .5);
            setTimeout(() => {
                botonRegistrar.css({
                    'display': 'block',
                    'opacity': '0.4',
                    'cursor': 'default'
                })
            }, 800);
            inputNombre.focus();

            inputNombre.on('input', function() {
                // console.log($(this).val().length);
                if ($(this).val().length > 2) {
                    botonRegistrar.css({
                        'opacity': '1',
                        'cursor': 'pointer'
                    })
                } else {
                    botonRegistrar.css({
                        'opacity': '0.4',
                        'cursor': 'default'
                    })
                }
            })

            // setTimeout(() => {
            // }, 1000);

        }

        // function activarBoton() {
        //     parpadear(botonRegistrar);
        // }

        botonRegistrar.click(function() {
            if (botonRegistrar.css('cursor') == 'pointer') {
                // aplicacion.siguientePagina();
                var elNombre = inputNombre.val();
                parent.elUsuario = elNombre;
                parent.registraIniciado();
                iniciaRecursos(elNombre);
            }
        });


        function iniciaRecursos(cualNombre) {
            console.log('iniciaRecursos con usuario', cualNombre);

            animacionSalida(img02, 'default', .2, 0);
            animacionSalida(inputNombre, 'default', .2, 0);
            animacionSalida(botonRegistrar, 'default', .2, 0);

            animacionEntrada(botonRecurso1, 'aparecer', 1, .5);
            animacionEntrada(botonRecurso2, 'aparecer', 1, .5);

            // setTimeout(() => {
            //     leeRecursos(cualNombre);
            // }, 500);

        }


        function leeRecursos(cualNombre) {
            console.log('leeRecursos', cualNombre);

            for (a = 1; a <= cuantosRecursos; a++) {

                console.log('el estatus del recurso ' + a + ':', parent['recursoEstatus' + a]);

                if (parent['recursoEstatus' + a] == 'incomplete') {
                    animacionEntrada(that['palomaAmarilla' + a], 'aparecer', 1, .5);
                } else if (parent['recursoEstatus' + a] == 'completed') {
                    animacionEntrada(that['palomaVerde' + a], 'aparecer', 1, .5);
                } else if (parent['recursoEstatus' + a] == 'passed') {
                    animacionEntrada(that['palomaVerde' + a], 'aparecer', 1, .5);
                } else if (parent['recursoEstatus' + a] == 'failed') {
                    animacionEntrada(that['palomaGris' + a], 'aparecer', 1, .5);
                } else if (parent['recursoEstatus' + a] == 'noVisitado') {
                    animacionEntrada(that['palomaGris' + a], 'aparecer', 1, .5);
                }

                that['botonRecurso' + a].click(function(e) {
                    e.preventDefault();
                    if ($(this).css('cursor') == 'pointer') {
                        let cualRecurso = parseInt($(this).attr('id').substr(12, 2));
                        elRecursoNum = cualRecurso;
                        lanzaRecurso(cualRecurso);
                    }
                });

            }
        }



        function lanzaRecurso(cualRecurso) {
            console.log('lanzaRecurso', cualRecurso);

            let laVentana = window.open('../recursos/' + that['recurso' + cualRecurso] + '/index.html', '_blank', 'toolbar=no, scrollbars=no, titlebar=no, status=no, menubar=no, location=no, resizable=yes, top=0, left=0, width=' + screen.width + ', height=' + screen.height + '');

        }


        function estatusReurso(estado) {
            if (estado == null || estado == undefined || !estado) {
                estado = 'incomplete';
            }
            parent.registraEstatusRecurso(elRecursoNum, estado);
        }
    </script>
</body>

</html>